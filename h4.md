h4 Some Disassembly Required

Tehtävänanto löytyy osoitteesta:
https://terokarvinen.com/application-hacking/#laksyt

 b)
 Aloitin tehtävän lataamalla tehtävänannosta ezbin-challenges.zip tiedoston. Tiedosto olikin sama kuin viimetehtvässä
 joten unzip komennon suorittaessa ylikirjoitin vanhan tiedoston. Muistin että packd binäärissä on packattu tiedosto,
 jonka arvelin tulevan esteeksi myöhemmin joten unpackasin sen komennolla "upx -d packd" niinkuin edellisessä tehtävässä.
 Tämä antoi palautteen "Unpacked 1 file." joten nyt voin alkaa tutkia binääriä ghidrassa.

 Importtasin tiedoston packd ghidraan ja ajoin sen samalla suorittaen analyysin. Main funktio löytyi ja aloin tarkastelemaan
 sitä decompile työkalulla.
 <img width="673" height="328" alt="kuva" src="https://github.com/user-attachments/assets/5ba4211b-f0e8-4c05-94f1-30a50f6d28cb" />
 Kuvassa olin ehtinyt jo muuttaa message muuttujan nimen ensimmäisen vilkaisun aikana, koska se oli mielestäni looginen.
 Hetken tutkailtuani ohjelmaaa tajusin sen toiminnan ja rupesin muuttamaan muuttujia ja funktioiden nimiä.
 Muutokset:
 iVar1 = checkResult nimiseksi, koska sen arvoa käytetään vertaamaan if lausekkeeessa salasanan oikeellisuutta.
 local_28 = input nimiseksi, koska sitä vertaillaan oikeaan salasanaan eli kyseessä on käyttäjän syöte.
 __isoc99_scanf = scanf nimiseksi siivotakseni nimeä. scan tuli jo edellisestä nimestä ja kertoi että tällä scannataan käyttäjän syöte.
message muuttujan vaihdoin ennen kuin kerkesin ottaa sen vanhaa nimeä ylös :D.

Uusisien nimien myötä main funktiosta tuli helposti ymmärretävämpi
<img width="673" height="328" alt="kuva" src="https://github.com/user-attachments/assets/c4170d88-5bea-4a52-86d5-5b2264b9868c" />
Main toimii siis niin että se lukee kirjoittamasi tekstin, vertaa sitä sanaan "piilos-AnAnAs" ja tulostaa lipun vain jos ne ovat tismalleen samat.

c)
Avasin passtr binäärin ghidrassa ja aloin tutkimaan sen main funktiota. Koitin lisätä muokkauksia suoraan compiler näkymään
joka ei kuitenkaan toiminut vaan aiheutti vaan koko ghidran jäätymisen. En saanut ghidraa suljettua käyttöliittymän sulku
painikkeista joten kysyin tekoälyltä nopesti miten saan terminaalissa suljettua ghidran. Komennolla "killall -9 java"
Sulku onnistui ja pääsin kokeilemaan uudestaan. Etsin tietoa siitä miten koodia voi muokata ghidrassa ja löysin raportin
jossa kerrottiin tästä(EDITING AN EXECUTABLE BINARY FILE WITH GHIDRA, 2019). Raportissa näin kuinka compiler ikkunassa voi klikkaamalla
haluttua kohtaa avata sen kohdan binäärissä ja muokata sitä siellä. Niimpä klikkasin if lausekkeen alkuvertailua, joka avasi kohdan listing ikkunassa.
<img width="1383" height="661" alt="kuva" src="https://github.com/user-attachments/assets/54e52d4a-4c9c-4e98-a5aa-019da02d230c" />
En tajunnut mitä koodissa tulee muuttaa, joten kysyin tekoälyltä mitä näkyvät TEST ja JNZ tarkoittaa. Opin että ne ovat hyppykäskyjä,
jossa Test on vain vertailu ja JNZ "Jump if Not Zero" on hyppykäsky joka toteutetaan jos test ei palauta 0.
Muutin JNZ rivin muotoon JZ "Jump if Zero", jolloin ehto compilerissä muuttui päinvastaiseksi. Rivin muuttaminen onnistuu klikkaamalla kohtaa ja valitsemalla "Patch Instruction". Nyt se palauttaa flagin ja oikein viestin vain jos salasana on joku muu kuin
"sala-hakkeri-321".
<img width="1389" height="618" alt="kuva" src="https://github.com/user-attachments/assets/0fec6330-6738-4417-b20e-ecc6647dede3" />
Raportissa kerrottiin kuinka exportataan uusi versio ohjelmasta valikosta valitsemalla file -> Export program. Exportasin uuden "modified" tiedoston 
samaan pasttr kansioon muodossa "Raw Bites". Annoin käyttöoikeudet exportattuun ohjelmaan komennolla chmod +x pasttr_modified, jotta voin ajaa sen
<img width="946" height="248" alt="kuva" src="https://github.com/user-attachments/assets/9396af44-248b-4371-b3fe-f6d9e2ea67f2" />

Sain kuitenkin vihreen "Muistialueen ylitys".
Kokeilin exportata uudestaan, mutta valitsin formaatiksi "Original file" "Raw Bytes" sijaan.
<img width="946" height="248" alt="kuva" src="https://github.com/user-attachments/assets/ac759303-31f4-4df1-87fb-929c0596682b" />
Annoin taas käyttöoikeudet ja nyt sitä pystyi ajamaan. Kokeilin salasanaa "kissa", joka palautti oikean salasanan viestin eli muokkaus toimi.
<img width="946" height="248" alt="kuva" src="https://github.com/user-attachments/assets/f9b39c7f-eef4-4ba6-9520-59a3bb3c4020" />

d)


Lähteet:
https://blog.cjearls.io/2019/04/editing-executable-binary-file-with.html
Gemini 3 Pro 
