# h2 Break & Unbreak.md

## x)
### OWASP 10
Broken access control: Käyttäjän pääsynhallinnan valvomisen epäonnistuminen. Eli käyttäjät voivat suorittaa toimintoja, jotka ovat heidän käyttäjäoikeuksiensa ulkopuolella. Tämä oli yleisin tietoturvavirhe 2021 OWASP Top 10-listassa.

### Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf
ffuf on fuzzer, jolla voi automatisoida haavoittuvuuksien etsimisen web-sovelluksista. ffuf avulla voit valita kohteen ja syöttää sille sanalistan, jonka jälkeen se lähettää tuhansia pyyntöjä sivulle sekunneissa testaten kaikkia mahdollisia komboja sanalistasta esimerkiksi urliin.
Pyyntöjen jälkeen se kertoo eri pyyntöjen vastaukset joita voit tutkia ja tulkita. 

### PortSwigger: Access control vulnerabilities and privilege escalation
Verkkosovellusten kontekstissa pääsynhallinta on riippuvainen tunnistautumisesta ja istunnonhallinnasta. Se määrittää onko käyttäjän sallittua suorittaa toiminto, jota hän yrittää tehdä.
Tapoja estää pääsynhallinan haavoittuvuudete: 
Jos resurssin ei ole tarkoitus olla julkisesti saatavilla, kiellä pääsy oletuksena (deny by default).
Käytä aina yhtä sovelluksen laajuista mekanismia pääsynhallinnan valvontaan jos mahdollista.
Tee kooditasolla pakolliseksi, että kehittäjät määrittelevät kullekin resurssille sallitun pääsyn ja kiellä pääsy oletuksena.

## Ympäristö
Tein tehtävän samsungin kannettavalla tietokoneellani ja siihen asennettelulla Oraclen Virtualbox ohjelmalla, jossa minulla pyöri Linux Ubuntu. 

## a)
Tehtäväni alustus sujui hyvin ja asensin tarvittavat paketit tehtävänannon  mukaisesti, jotta ensimmäisen tehtävän sivun sai auki. 
Testasin pin coodin kenttään 'OR 1=1;-- Tästä tuli kuitenkin vain ilmoitus "Kirjoita luku.". Muutin input elementtiä muotoon type=text jolloin 'OR 1=1;-- antoi salasanan foo. Tämä on jonkun toisen salasana mutta ei adminin. Nyt tiedätään siis että sovelluksessa on haavoittuvuus, joka mahdollistaa sql-injektion. Aloin selvittämään miten voin etsiä vihjeen SUPERADMIN avulla salasanan. Löysin sql LIKE komennon joka sopii juuri tälläisiin tilanteisiin jossa tiedetään osa salasanasta. LIKE komennolla % merkkien kanssa voi ns etsiä mitä tahansa tekstiä tietokannasta. Laittamalla kenttään lause ' OR password LIKE '%SUPERADMIN%' saadaan sivulta palautettua salasasana SUPERADMIN%%rootALL-FLAG{Tero-e45f8764675e4463db969473b6d0fcdd} .

Käytetty hyökkäysmerkkijono oli: ' OR password LIKE '%SUPERADMIN%
Hyökkäys toimii seuraavasti:
' : Sulkee alkuperäisen koodin PIN-kentän määrittelyn tyhjäksi, jotta voimme lisätä oman ehtomme.
OR: Kertoo tietokannalle, että rivi hyväksytään, jos jompikumpi ehto on tosi.
password LIKE: Kohdistaa haun password-sarakkeeseen ja käyttää LIKE-operaattoria, joka mahdollistaa osittaiset osumat.
'%SUPERADMIN%': Itse hakutermi. Prosenttimerkit % toimivat jokerimerkkeinä. Lauseke tarkoittaa: "Hyväksy salasana, jonka sisällä on teksti SUPERADMIN, riippumatta siitä mitä merkkejä on ennen sitä tai sen jälkeen."

## b)


Lähteet:
https://www.w3schools.com/sql/sql_like.asp
